\documentclass[12pt,preprint]{aastex}

\usepackage{amsmath}
\usepackage{xspace}     % fixes spaces after custom commands
\usepackage{float}      % exact placement of figures (using \begin{figure}[H])
\usepackage{subfigure}  % does what it says

\usepackage{graphicx}
% prefere pdf over png (better quality, lossless compression)
\DeclareGraphicsExtensions{%
  .pdf,.PDF,%
  .png,.PNG,%
  .jpg,.mps,.jpeg,.jbig2,.jb2,.JPG,.JPEG,.JBIG2,.JB2}

%\usepackage{longtable}   % those two to generate the 2 ol table
%\usepackage{multicol}

\def\half{{\textstyle\frac12}}
% makes it easier to have consistent writing, and easy change if needed
\newcommand{\spl}{SpaghettiLens\xspace}
\newcommand{\sw}{SpaceWarps\xspace}

% shortcut for einstein radius (Text Greek Full Math)
\newcommand{\ER}{Einstein radius\xspace} % text
\newcommand{\ERg}[1][]{$\Theta_{\text{E#1}}$\xspace} % er in textmode with greek
\newcommand{\ERf}[1][]{Einstein radius $\Theta_\text{E#1}$\xspace} % full output
\newcommand{\ERm}[1][]{\Theta_\text{E#1}} % mathmode with greek symbol

%shortcuts for kappa
\newcommand{\kenc}[1][r]{$\kappa_\text{encl}(#1)$\xspace}
\newcommand{\kap}[1][r]{$\kappa(#1)$\xspace}

% shorcuts for refs (use capital for beginning of sentence)
% first 3 are for the real layz people..
\newcommand{\fref}[1]{\ref{fig:#1}}
\newcommand{\sref}[1]{\ref{sec:#1}}
\newcommand{\tref}[1]{\ref{tab:#1}}
\newcommand{\figref}[1]{Figure~\ref{fig:#1}}
\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\tabref}[1]{Table~\ref{tab:#1}}
\newcommand{\Figref}[1]{Figure~\ref{fig:#1}}
\newcommand{\Secref}[1]{Section~\ref{sec:#1}}
\newcommand{\Tabref}[1]{Table~\ref{tab:#1}}

% shortcut for ASW000xxxx
\newcommand{\asw}[1]{ASW000#1\xspace}
\newcommand{\model}[2][Model~]{#1#2\xspace}

%degrees
\newcommand{\dgr}{^{\circ}}


% todo annotations on side in red. easy to search for at the end
% !!! REMOVE THIS LINES FOR FINAL COMPILE
%
\usepackage{setspace}    % remove this pgk for final compile!! 
\usepackage{color}    % well... color...

\newcommand{\todo}[2][red]{%
\textcolor{#1}{\textbullet}%
\marginpar{\colorbox{#1}{\parbox{\marginparwidth}{%
\setstretch{0.4}\sffamily\textcolor{black}{\scriptsize{#2}}}}}}

\newcommand{\needfig}[1][]{%
\colorbox{yellow}{\parbox{0.5\textwidth}{%
\vspace{0.5cm}\setstretch{0.5}\textcolor{black}{\scriptsize{fig #1}}\vspace{0.5cm}}}%
\marginpar{\colorbox{yellow}{\parbox{\marginparwidth}{%
\setstretch{0.4}\sffamily\textcolor{black}{\scriptsize{fig}}}}}}

\setlength{\marginparsep}{0mm}
\setlength{\marginparwidth}{2.2cm}

\newcommand{\needcite}[1][]{\todo[green]{cit #1}}
\newcommand{\needref}[1][]{\todo[cyan]{ref #1}}
\newcommand{\needchk}[1][]{\todo[red]{chk #1}}

% \\\ END OF REMOVAL SECION


\newcommand{\hr}{\vspace{5mm}\noindent\rule{0.8\textwidth}{0.4pt}\vspace{5mm}}


\begin{document}

\title{Lens Modeling in \sw}
\author{Rafael Kueng,\altaffilmark{1}
Phil Marshall,\altaffilmark{2}
Anupreeta More,\altaffilmark{3}
Aprajita Verma,\altaffilmark{4}
Amit Kapadia,\altaffilmark{5}
Elisabeth Baeten,\altaffilmark{6}
Claude Cornen,\altaffilmark{6}
Christine McMillan,\altaffilmark{6}
Julianne Wilcox,\altaffilmark{6}
Jonas Odermatt,\altaffilmark{7}
Jonathan Coles,\altaffilmark{8}
Surhud More\altaffilmark{3}
and Prasenjit Saha\altaffilmark{1}
}
\altaffiltext{1}{Physik-Institut, University of Zurich, 190 Winterthurerstrasse, 8057, Zurich, Switzerland}
\altaffiltext{2}{Kavli Institute for Particle Astrophysics and Cosmology, Stanford University, 452 Lomita Mall, Stanford, CA 94035, USA}
\altaffiltext{3}{Kavli Institute for the Physics and Mathematics of the Universe, University of Tokyo, 5-1-5 Kashiwanoha, Kashiwa-shi 277-8583, Japan}
\altaffiltext{4}{Oxford Astrophysics, Keble Road, Oxford OX1 3RH, UK}
\altaffiltext{5}{Adler Planetarium, 1300 S. Lake Shore Drive,
  Chicago, IL 60605, USA}
\altaffiltext{6}{Spacewarps}
\altaffiltext{7}{Kantonsschule Zug, L\"ussiweg 24, 6300 Zug, Switzerland}
\altaffiltext{8}{Exascale
  Research Computing Lab, Versailles Saint-Quentin-en-Yvelines
  University, 55 Avenue des Etats Unis, 78000, Versailles, France}

\begin{abstract}
In the initial phase of \sw (SW1), volunteers were invited to search the CFHTLS sky survey to look for gravitational lenses.
Here we report on a web application that gives experienced volunteers the opportunity to model the candidates that have been identified.
In order to gauge the quality of the models that were being rendered, these same volunteers were invited to model a sample of 29 simulated lenses.
The models were then examined in greater detail, with particular attention being paid to the following:
(i)~identification of image parities and time arrivals;
(ii)~the mean convergence (equivalent to the enclosed mass), and finally;
(iii)~the performance of a volunteer vs. a professional.
In most cases, the volunteers were found to correctly identify the image parities and time arrivals.
% Einstein radius +~20%
 along with a mean convergence that was well constrained within the image region;
In all, the results could be comparable to that of a professional.


\end{abstract}

\keywords{}
\section{Introduction}


Galaxies and clusters of galaxies are considered to be the largest structures in the known Universe. When one questions their formation,  the present picture suggests that gravitational instabilities  (observable as fluctuations of the microwave background) 
 \todo[red]{not too sure of the relevance of this statement} 
 - caused a collapse into gravitationally bound structures. 
 \todo[yellow]{clarification needed: are they becoming gravitationally bound structures, or are they collapsing into objects that are already gravitationally bound? I know it is most probably the later, but it is a bit ambiguous}   
The initial collapse would have been dominated by dark matter, but once deep wells had appeared in the gravitational potential, gas would have started falling into those wells. 
\todo[red]{not too sure of this wording}
Through atomic processes,
\todo[yellow]{perhaps we need to clarify those processes or are they generally know?}
 the gravitational potential energy of this gas would of been radiated away, leading to the formation of the largest stars. 
\todo[red]{or perhaps just stars?}
In turn, galaxies and clusters of galaxies would form, all the time merging and changing their form.
This rough outline is now well established, but in order to satisfy our understanding of this process, there are many puzzles  that remain to be solved. For progress to be made, we need to extend our knowledge of dark matter. Gravitational lensing has proven as a particularly attractive way of studying dark matter as it is only dependant on mass.
\todo[yellow]{silly question, but shouldn't we briefly explain why it is only dependant on mass? or should everyone already reading this paper know that? or is it explained later?}


There are many manifestations of gravitational lensing in astrophysics,
but the most spectacular are multiple images.  Gravitational lensing
depends on the sky-projection mass density, and this fact has a
counter-intuitive consequence: nearby galaxies do not produce multiple
images, because their projected density is not high enough, but beyond
100~Mpc or so, most galaxies are potential lenses.  Even so, for a
potential lens to really act as a lens, a background source in the close-by
region is required.  So, in practice galaxies are very rarely observed
as lens.  The same tendency applies to clusters of galaxies, but since
clusters are bigger, they are more likely lens-like.

In lensing galaxies, the observable features usually involve a single
object multiply imaged.  It is therefore desirable to have large
numbers of lenses, and this is the strategy researchers are following.  The
largest single study so far uses 58 lenses \citep{2009ApJ...703L..51K}.
Other studies have compared lens models in more detail with stellar
mass \citep{2011ApJ...740...97L} or used time-delay information from
lensed quasars to infer the Hubble time
\citep{2008ApJ...679...17C,2010ApJ...712.1378P}.

The trend is clear: researchers want to find many more lenses and
model them in more sophisticated ways.

\begin{figure}[h]
\centering
\includegraphics[width=.7\hsize]{fig/lenssky}
\caption{Sky distribution of 398 published lenses considered secure as
  of September 2013 (from the Masterlens catalog at the University of
  Utah, maintained by Joel Brownstein and Leonidas Moustakas.) The map
  is in Hammer-Aitoff projection, with North up and $\rm RA=0$ in the
  middle.  The empty swathes to the left and right of center are the
  Milky Way.}
\label{fig:masterlens}
\end{figure}

A good summary of the observational situation is offered by
Figure~\ref{fig:masterlens}, which shows known secure multiply-imaging
lenses.  The non-uniformity on the sky is not intrinsic, it just
indicates the density of deep surveys up to 2013.  At HST resolution,
of order 1~square degree of sky must be searched to find a lens.
Older ground-based surveys yield a lens per roughly 10~square degree
of survey area.  By the large surveys starting now
(DES\footnote{\tt http://pan-starrs.ifa.hawaii.edu} or
PanStarrs\footnote{\tt http://www.darkenergysurvey.org}) the expected
yield is something in between.  Given their unprecedented survey area,
these are likely to yield thousands of lenses.  Over the 2020s,
LSST\footnote{\tt http://www.lsst.org/} can be expected to give us ten
thousand lenses.

The question now arises: can lenses be found and modeled
automatically in large surveys?  Work using software robots
\citep{2009ApJ...694..924M} gives some interesting and unexpected
results.  In clean lensing system in uncrowded fields with high
signal-to-noise, the robots do very well.  In most situations,
however, robots miss lenses (low completeness) or contaminate the
results with non-lenses (low purity).  Robots can be made to
prioritize completeness or purity, but they cannot deliver both.

In response to the lessons learned from automated lens searches, the
{\em Spacewarps\/} project\footnote{\tt http://www.spacewarps.org}
 has been launched.  {\em Spacewarps\/} is
part of the {\em Zooniverse\/} family of citizen-science
projects,\footnote{\tt http://www.zooniverse.org} where members of the
public are invited to analyze different kinds of scientific data which
are too difficult for robots and too large for specialists.  In {\em
 Spacewarps\/} itself, survey sky images are presented for volunteers to identify lens candidates.  The first tranche of survey data, introduced from May 2013, is an area of $\sim172$ square
degrees (or a quarter of a percent of the sky) from the Canada-France-Hawaii Telescope Legacy Survey.
 The survey is divided into patches of $440\times 440$ pixels, each of
which is seen by ten volunteers.  Simulated lenses are mixed in with
the data, both to help train volunteers on what to look for, and to
estimate completeness and purity.
These data had previously been analyzed by robots \cite{Gavazzi2012, More2012ApJ}.  
  A list of candidates is being
processed, but intermediate results show some very good candidates, as
well as re-discoveries of candidates previously found robotically.

These encouraging results now raise the question: could modeling of
the lenses also be done by volunteers?  Modeling is a much more
difficult task than searching for lens candidates, as it requires some
expert knowledge.  Nonetheless, a panel of the {\em Spacewarps\/}
volunteers is quite experienced from earlier projects, having spent a
thousand hours or more with data.  Some of these experienced
volunteers are very interested in more demanding projects.  This also
is a general trend \citep[cf.][]{Khatib22112011}.  The present project
then suggests itself.

The purpose of this study was to provide a means to model a large number of gravitational lenses by showing that gravitational lens modeling can be learned / done by volunteers.
We suggest, that volunteers will be as successful as professionals with modeling if provided with an easy to use tool with visual feedback (What you see is what you get, WYSIWYG) and a minimal set of instructions.
Volunteers will then crowd work (using buzz word here ;) ) / work collaborative on modeling lenses from several sources / groups at a central place.
Since this is an iterative learning process, the more involved volunteers will quickly gain knowledge that can be passed down to new volunteers.
That creates a social structure that scales well with the number of volunteers, as other projects\needcite have already shown.
Finding people working as volunteers has been shown to be successful last but not least by \sw and the whole galaxy zoo project.
To test the people's abilities, we investigated the performance of a few volunteers modeling a set of simulated lenses.
We tested the ability to correctly identify lensed images and reproduce similar mass map of the lens.


\section{A lens modeling program}

It is well known that making a scientific contribution is a central
motivation cited by citizen-science volunteers.  So for a lens
modeler in a citizen-science project, nobody wants that it should
sacrifice scientific usefulness in order to be fun to use.  That said,
being aesthetically pleasing and having a short initial learning curve
are also essential qualities.  Also desirable is that the user is
encouraged/challenged to go deeper and wider into the subject.
Yet another aspect is enabling small incremental contributions
by different people.  \spl tries to address all of these.

\subsection{Theory: Fermat's Principle} \label{sec:Fermat}

There are several ways to understand the formation of arcs and
multiple images in gravitational lensing.  We will follow some ideas
originally introduced by \cite{1986ApJ...310..568B}, based on Fermat's
principle.  The key to this approach is an abstract construct called
the {\em arrival-time surface.}  This surface cannot itself be
observed, but several observable quantities can be derived from it.

Consider a gravitational lens.  As in most astrophysical lensing, this
lens is `thin' along the line of sight, and effectively lies on a
plane.  Let $x,y$ be coordinates on this plane.  These coordinates
measure ordinary physical lengths (meters, etc) on the lens plane.
Let there be a point source of light at $x=0,y=0$ but far behind the
lens plane.  Now imagine a light ray coming from the source to the
lens plane $(x,y)$ and then changing its path to reach the observer.
The observer would see the source apparently behind $(x,y)$ the
lens.  If this happened, the light ray would have taken a longer path
than having come directly to the observer.  The geometrical path
difference would be $\propto x^2 + y^2$ for small angles.  Let us
define
\begin{equation} \label{eq:Ageom}
A_{\rm geom}(x,y) = \half(x^2 + y^2) \,.
\end{equation}
As written, this looks an area.  But we can also think of it as a
time delay introduced by the light ray bending --- with an unwritten
constant factor.  That factor is basically the lens distance divided by the
speed of light; the precise expression has to take the expansion of
the Universe into account, and is given in the Appendix.  The top part
of \figref{arriv} shows what $A_{\rm geom}$ looks like: it is
just a paraboloid.  The minimum of the surface is at the source, and
that is where, according to Fermat's principle, the image will be.
The rest of the arrival-time surface is just an imaginary surface.

\begin{figure}
\centering
\includegraphics[height=.3\vsize]{fig/arriv1}
\includegraphics[height=.3\vsize]{fig/arriv2}
\includegraphics[height=.3\vsize]{fig/arriv3}
\caption{Arrival-time surfaces, with contour levels of equal arrival
  time.  The upper surface is with no lens.  The middle surface is
  when a circular lensing mass (offset from the source) is added; a
  maximum, a minimum and a saddle point can be seen.  The last surface
  is the result of an elongated lensing mass; a maximum, two minima
  and two saddle points can be seen.
}
\label{fig:arriv}
\end{figure}

The geometrical time delay \eqref{eq:Ageom} is not the only one.  The
warping of space by a gravitational field introduces a further time
delay $A_{\rm grav}$.  The arrival time of the light ray, compared to
what it would have been with no lensing, is
\begin{equation} \label{eq:Aarriv}
\hbox{arrival time} = A_{\rm geom} + A_{\rm grav} \,.
\end{equation}
We can also express $A_{\rm grav}$ as an area, with the same implicit
constant factor that makes it a time.  The expression, however, is
more complicated.  We first introduce the notation $\nabla^2 f(x,y)$
to denote
\begin{equation}
 \frac{ f(x+\Delta x, y) + f(x-\Delta x, y) +
        f(x, y+\Delta y) + f(x, y-\Delta y) - 4 f(x,y) }
      {\Delta x \; \Delta y}
\end{equation}
in the limit of $\Delta x,\Delta y$ small.  Then we write the
projected mass density of the lens, which would be in $\rm
kg\,m^{-2}$, in special units (given in the Appendix) such that the
surface density becomes a dimensionless field $\kappa(x,y)$.  Then
\begin{equation} \label{eq:Poisson}
\nabla^2 A_{\rm grav}(x,y) = -2\kappa(x,y) \,.
\end{equation}
Note that $A_{\rm grav}(x,y)$ is not given explicitly in terms of
$\kappa(x,y)$, but as a differential equation that must be solved.
Equations of the type \eqref{eq:Poisson} are, however, well known (as
Poisson's equation in two dimensions), and there are techniques for
solving them.  Incidentally, $\kappa$ has a second meaning, as well as
being a dimensionless form of the projected density: it also
measures how a bundle of light rays is brought together by
gravitational lensing, and is called the {\em convergence}.

What is the effect of mass on the arrival-time surface?  If the mass
distribution $\kappa(x,y)$ is circular, $A_{\rm grav}(x,y)$ will have
a peak at the center of that circle.  But if the mass is not precisely
in front of the source, the arrival-time surface will not be circular
any more.  The result is illustrated in the middle part of
\figref{arriv}.  In addition to the maximum, there is now a
minimum and a saddle point.  According to Fermat's principle, images
appear at maximum and saddle points as well as minimum.  If the mass
distribution is non-circular, more images can appear.  The lower
example in \figref{arriv} shows the arrival-time surface due
to an elongated mass.  There is still a maximum, part of an elongated
hill, and around it there are two minima and two saddle points.

So far we have considered a single point source.  What if there is an
extended source?  To understand this, let us consider what happens if
we move the original point source slightly, or equivalently, keep the
original point source behind $x=0,y=0$ and move the lens slightly.
The contours of constant arrival time will naturally move slightly,
and so will the images.  The movement of the contours will be most
noticeable where the contours are far apart, that is where the
arrival-time surface is nearly flat.  As is evident from
\figref{arriv}, this is the region where the minimum and saddle
points lie, or near the images.  In this region, points on the source
that are close together produce images that are comparatively far
apart.  In other words, the image is highly magnified.  In summary,
lower curvature in the arrival-time surface for a point source implies
larger magnification of an extended source.  Conversely, where the
arrival-time surface is strongly curved, the image will be
demagnified.  We see from \figref{arriv} that the arrival-time
surface tends to be highly curved near the maximum.  Hence maximum tend
to be demagnified.  In practice, maxima of the arrival time are nearly
always too faint to see. The minima and saddle points dominate.

In the lensed examples in \figref{arriv}, the maximum in each
case is evident, but how can we distinguish the minima from the saddle
points?  The key is to examine the contours of equal arrival time.
Contour curves loop around a minimum or a maximum, but near a saddle
point, the contours do not loop around, instead they approach and then
pull away.  The contour curve precisely level with a saddle point
forms an X at the saddle point.  In \figref{arriv}, one such X
is evident.  In other cases the X contour passing through the saddle
point is not itself plotted, but we can tell by the other contours where
the X would be.  These self-crossing contours will play a special role
in the following.

\subsection{\spl} \label{sec:SpaghettiLens}

\spl implements the ideas of the arrival-time surface into a modeling
program.

\begin{figure}
  \centering
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/006941_input}} \\
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/007022_input}} \\
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/006919_input}}
  \caption{Examples of Spaghetti input.  The models from these appear
    later in Figures \ref{fig:6941}, \ref{fig:7022} and \ref{fig:6919}.
  }
  \label{fig:input-spag}
\end{figure}

The first modeling step with \spl is for the user to call up the \sw
of interest, and make an educated guess for the topography of the
arrival-time surface --- specifically, the locations of the maxima,
minima and saddle points that correspond to images of the brightest
part of the source.  Input is given by tracing a proposal for the
saddle-point contours.  \Figref{input-spag} shows some example
inputs --- and incidentally also indicates the origin of the name
\spl.

\spl, as implemented so far, assumes that the lens is dominated by a
single galaxy, and that the center of that galaxy is the sole maximum.
Once the maximum has been identified, we wish to characterize the rest
of the arrival-time surface in relation to it.  From geometry, any
surface that has a central maximum and goes high at the edges must
have a lima\c con-like contour, meaning a two-looped curve with one
loop inside the other.  The maximum lies within the inner loop, a
minimum lies between the two loops, and a saddle point lies at the
self-intersection of the contour.  The top panel of
\figref{input-spag} shows an example: red marks a suggested
maximum, green a saddle point, and blue a minimum.  (The small pink
dots are just help sketch the proposed contour.)  The middle and lower
panels of \figref{input-spag} show a more complex situation.
The minimum has split into three images: two new minima with a saddle
point in between.  In this situation the contour through the new
saddle point forms a figure of eight, its two loops enclosing the two
new minima.  The configuration of a lima\c con, possibly with a figure
of eight inside, suffices to give a preliminary description of the
arrival-time surface for nearly all cases where the lens is dominated
by one galaxy, and the source is a single small object.

The exact placement of the pink spaghetti loops shown in
\Figref{input-spag} has no significance.  Their utility is
just to help mark up the image as maximum, minima and saddle points.
As the figure suggests, the marking up can be done very easily with a
mouse.  Human intuition is required to (a)~identify lensed images and
separate them from other background light sources, and (b)~classify
and order images according to arrival time.  But the computer helps by
allowing only valid lensing configurations to be entered, and ensuring
that the odd image theorem\needcite is taken care of.

In the second modeling step, once the user has sketched a proposed
spaghetti configuration, \spl sends the input to its server-side
modeling engine, called GLASS.  The task of GLASS is to find a mass
distribution $\kappa(x,y)$ that exactly reproduces the locations of
the maximum, minima and saddle points. Now, this criterion by itself
is extremely under-determined --- there are infinitely many mass
distributions that will reproduce a given set of maxima, minima and
saddle points, but typically they (a)~produce lots of extra images,
and (b)~look very unlike galaxies.  Additional assumptions (a prior)
are necessary.  GLASS uses a prior based on suggestions by
\cite{1997MNRAS.292..148S}.
\begin{enumerate}
\item The mass distribution is built out of non-negative tiles of
  mass.  (Sometimes these tiles are called mass pixels, but we should
  emphasize that they are unrelated to image pixels, and are much
  larger.)
\item There is a notional lens center, say $(x_0,y_0)$ which is
  identified with the maximum of the arrival time.  The source can
  have an arbitrary offset with respect to the lens center.
\item The mass distribution must be centrally concentrated, in two
  respects.  First, the circularly averaged density must fall away
  like $$ \left[(x-x_0)^2+(y-y_0)^2\right]^{-1/2}$$ or more steeply.
  Second, the direction of increasing density at any $(x,y)$ can point
  at most $45^\circ$ away from $(x_0,y_0)$.
\item The lens must be symmetrical with respect to $180^\circ$ rotations
  about $(x_0,y_0)$.  This symmetry assumption can be relaxed if the
  user wishes.
\end{enumerate}
There are still infinitely many models that satisfy both data and
prior constraints, but now they are more credible as galaxy lenses.
It is then possible to generate an ensemble of models.  The sampling
technique used by GLASS is described in \citep{Lubini2012}, and
improves upon earlier techniques \citep{2000AJ....119..439W,Saha2004}.
Typically, ensembles of 200 models are used.  That is to say, what we
call a \spl model is really the mean of an ensemble of 200 models, and
its estimated uncertainty is the range covered by the whole ensemble.

In the third modeling step, having generated a model ensemble, \spl
post-processes it to present results and diagnostics to the user for
inspection. This takes the form of three figures.
\begin{enumerate}
\item A gray scale plus contour map of the mass distribution.
\item A contour map of the arrival-time surface.
\item A synthetic image of the lensed features.
\end{enumerate}
After examining this feedback, the user can archive the results for
discussion, or modify their input and try again, or discard the
attempt altogether.

The fourth modeling step is discussion among modelers and iteration
on the model.  Any archived model can be revised by another user: they
can modify the spaghetti configuration slightly or drastically, or
change options like the size of the mass tiles.  Particularly
interesting lens candidates lead to trees of models in this way.
Forum discussion then prunes the tree, focusing attention on one or a
few models.

\section{A lens modeling challenge} \label{sec:mod_challenge}

% \subsection{\sw} \label{sec:SpaceWarps} some words about \sw

Interested volunteers from the \sw forum were initially introduced to
\spl through a video tutorial and by videocon.  After this
introductory stage, a modeling challenge was presented.  This
consisted of 29 simulated lenses (sims) covering a range of lensing
configurations.

The \sw sims were generated by AM, in consultation with PM and AV.
To estimate the performance of the volunteers and the quality of the generated models, two analysis  were done.
The first analysis tested the correct identification and ordering of lensed images.
The second one compared the mass distribution of the lens $\kappa(x, y)$ of the generated models to the mass distribution of the simulations.


\subsection{The simulated lenses} \label{sec:sims}

For the sake of blind testing, the information in this section was
revealed neither to RK, while choosing the challenge set of 29 sims,
nor to the modelers (volunteers EB, CC, CM, JO, JW and `expert
modeler' PS) until the modeling stage was done.

The sims were produced using {\tt gravlens}
\citep{2001astro.ph..2341K,2001astro.ph..2340K} using the CFHTLS survey data
and catalogues \cite{Coupon2009}. They were of three
kinds, as follows.

\begin{enumerate}
  \item Imitating lensed quasars: having a singular elliptical
    isothermal lens (SIE) plus constant external shear, and a circular
    Gaussian source.
  \item Emulating lensed galaxies: similar to the above, but with an
    elliptical de Vaucouleurs source.
  \item Resembling cluster lenses: having a source as above, but a
    more complicated lens, with one dominant elliptical SIE and
    one or more perturbing elliptical SIEs, plus a circular NFW
    \citep{1996ApJ...462..563N,1997ApJ...490..493N} to represent
    the underlying dark matter distribution.
\end{enumerate}

Formulas for the lenses appear in \cite{2001astro.ph..2341K}. The SIE
lenses follow equations (33--35) of that work, with core radius set to
zero.  The NFW lens is in equations (48) and (50), while shear is the
$\gamma$ term in equation (76).

\subsection{Some example models} \label{sec:example_models}

The modelers proposed a total of 129 models for the 29 sims in the
challenge.  Figures \ref{fig:6941} to \ref{fig:6919} show eight of
models in some detail.

\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6941_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW000102p_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6941_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW000102p_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6941_mass}
    \includegraphics[width=0.45\textwidth]{fig/006941_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6941_cont}
    \includegraphics[width=0.45\textwidth]{fig/006941_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6941_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006941_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6941_atime}
    \includegraphics[width=0.45\textwidth]{fig/006941_arr_time}
  }
  \caption[result 6941 (ASW000102p)]{Sim ASW000102p and a model.  A
    simple configuration; the model input is shown in the top panel of
    Figure~\ref{fig:input-spag}.  For details of the individual panels
    here, see section \ref{sec:example_models}.}
  \label{fig:6941}
\end{figure}
  
\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6975_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW000195x_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6975_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW000195x_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6975_mass}
    \includegraphics[width=0.45\textwidth]{fig/006975_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6975_cont}
    \includegraphics[width=0.45\textwidth]{fig/006975_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6975_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006975_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6975_atime}
    \includegraphics[width=0.45\textwidth]{fig/006975_arr_time}
  }
  \caption[result 6975 (ASW000195x)]{Sim ASW000195x and a
    model.}
  \label{fig:6975}
\end{figure}
  
\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6937_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000vqg_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6937_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000vqg_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6937_mass}
    \includegraphics[width=0.45\textwidth]{fig/006937_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6937_cont}
    \includegraphics[width=0.45\textwidth]{fig/006937_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6937_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006937_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6937_atime}
    \includegraphics[width=0.45\textwidth]{fig/006937_arr_time}
  }
  \caption[result 6937 (ASW0000vqg)]{Sim ASW0000vqg and a model.}
  \label{fig:6937}
\end{figure}

\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6990_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0004oux_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6990_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0004oux_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6990_mass}
    \includegraphics[width=0.45\textwidth]{fig/006990_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6990_cont}
    \includegraphics[width=0.45\textwidth]{fig/006990_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6990_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006990_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6990_atime}
    \includegraphics[width=0.45\textwidth]{fig/006990_arr_time}
  }

  \caption[result 6990 (ASW0004oux)]{Sim ASW0004oux and a model.}
  \label{fig:6990}
\end{figure}

\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6915_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0001hpf_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6915_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0001hpf_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6915_mass}
    \includegraphics[width=0.45\textwidth]{fig/006915_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6915_cont}
    \includegraphics[width=0.45\textwidth]{fig/006915_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6915_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006915_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6915_atime}
    \includegraphics[width=0.45\textwidth]{fig/006915_arr_time}
  }

  \caption[result 6915 (ASW0001hpf)]{Sim ASW0001hpf and a model. Inclined quad.}
  \label{fig:6915}
\end{figure}

  
\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:7022_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000h2m_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:7022_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000h2m_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:7022_mass}
    \includegraphics[width=0.45\textwidth]{fig/007022_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:7022_cont}
    \includegraphics[width=0.45\textwidth]{fig/007022_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:7022_kappa}
    \includegraphics[width=0.45\textwidth]{fig/007022_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:7022_atime}
    \includegraphics[width=0.45\textwidth]{fig/007022_arr_time}
  }

  \caption[result 7022 (ASW0000h2m)]{Sim ASW0000h2m and a model.  The
    model input appears in the middle panel of Figure
    \ref{fig:input-spag}.}
  \label{fig:7022}
\end{figure}
  
\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:7025_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000h2m_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:7025_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0000h2m_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:7025_mass}
    \includegraphics[width=0.45\textwidth]{fig/007025_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:7025_cont}
    \includegraphics[width=0.45\textwidth]{fig/007025_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:7025_kappa}
    \includegraphics[width=0.45\textwidth]{fig/007025_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:7025_atime}
    \includegraphics[width=0.45\textwidth]{fig/007025_arr_time}
  }

  \caption[result 7025 (ASW0000h2m)]{Sim ASW0000h2m and another model.  The image parities in this case were incorrectly identified.}
  \label{fig:7025}
\end{figure}
  

\begin{figure}
  \centering
  \subfigure[real mass distribution]{
    \label{fig:6919_sim_mass}
    \includegraphics[width=0.45\textwidth]{fig/ASW0002z6f_kappa}
  }
  \subfigure[real arrival-time surface]{
    \label{fig:6919_sim_arr}
    \includegraphics[width=0.45\textwidth]{fig/ASW0002z6f_arriv}
  }
  \subfigure[model mass distribution]{
    \label{fig:6919_mass}
    \includegraphics[width=0.45\textwidth]{fig/006919_mass}
  }
  \subfigure[model arrival-time surface]{
    \label{fig:6919_cont}
    \includegraphics[width=0.45\textwidth]{fig/006919_spaghetti}
  }
  \subfigure[real vs model enclosed mass]{
    \label{fig:6919_kappa}
    \includegraphics[width=0.45\textwidth]{fig/006919_kappa_encl}
  }
  \subfigure[model lensed image]{
    \label{fig:6919_atime}
    \includegraphics[width=0.45\textwidth]{fig/006919_arr_time}
  }
  \caption[result 6919 (ASW0002z6f)]{Sim ASW0002z6f and a model.  The
    model input appears in the bottom panel of Figure
    \ref{fig:input-spag}. An incipient quad}
  \label{fig:6919}
\end{figure}

Figure \ref{fig:6941} shows a simple example.  The top two panels show
contours of convergence $\kappa(x,y)$, and of the arrival-time for a
point source at the brightest point of the sim
source.\footnote{Although the arrival-time contours represent an
  abstract quantity that is not directly observable, the contour map
  may actually resemble the appearance of the lensed arcs.  The
  resemblance is due to a serendipitous computer-graphical effect
  \citep{2001AJ....122..585S}.} The spatial scale is in pixels.  The
information in these two panels was, of course, kept secret during the
modeling challenge.  The panels in the middle row and at the lower
right are the results that \spl returns to the modeler, in order for
them to assess the model.  These derive from the mean of an ensemble
of 200 models generated by \spl.  The model mass distribution (left mid) is
returned as a contour map superimposed on an intensity map. A fairly
smooth mass distribution, as here, is a good sign.  An irregular or
checkboard pattern in the mass map usually indicates a bad model.  The
models arrival-time contours are shown in the right middle panel.
  The special contour passing through a
saddle point is shown in black: this is the model version of the
spaghetti sketch provided by the user.  Also provided is a synthetic
image of the lensed source in the bottom right panel.
  For this, \spl assumes a simple conical
source profile.  The user can change the contrast level on the image,
which (though it is not saved) amounts to adjusting the width of
the cone.  Finally, to the lower left of the figure, we have a
comparison of the input and recovered mass profiles.  The panel shows
a average $\kappa$ within a given radius, as a function of radius.
The red curve is the true value, and where it crosses unity (dotted
horizontal line) is the notional Einstein radius $\Theta_{\text{E, sim}}$.
  The two blue curves
are the minimal and maximal mean enclosed $\kappa$ from the internal
ensemble in \spl.  The region between the blue curves is shaded
between the radii of the innermost and the outermost images --- this
is the confidence region from the modeling.  As we see, the shaded
blue is slightly above the red curve. 
The Einstein Radius $\Theta_\text{E}$ of the model is estimated crossing the
mean enclosed $\kappa$ (not plotted) with unity.
  In summary: the identification
of minimum and saddle point is correct, but the estimated Einstein
radius is a little too high.

Figure \ref{fig:6975} shows a lens with substructure in the form of a
smaller secondary galaxy.  The galaxies in such group or cluster sims
were, in fact, based on galaxies visible in the images --- but the
modelers were not told in advance whether this was the case.  The
model does not include any substructure, but otherwise is not bad.
The minimum and saddle point are correct, and the Einstein radius is
only a little underestimated.

Figure \ref{fig:6937} shows a case where substructure leads to a
poor model.

Figure \ref{fig:6990} shows an example of an arc that has split into
three images.  This kind of configuration, with a counter-image close
to the lensing galaxy and a more distant arc/triplet on the other
side, generically arises from an elongated mass distribution when the
source is displaced along the elongated direction.

Figure \ref{fig:6915} shows another quad.  This kind of configuration
arises when the mass is elongated and the source is displaced at an
angle to the elongation.

Figure \ref{fig:6975} shows a fairly symmetric quad.  The minima and
saddle points are correctly identified, and the orientation of the
ellipticity of the mass distribution is correctly reproduced.  The
Einstein radius is somewhat overestimated.  Figure \ref{fig:7022}
shows another model of the same system.  In this one, the
identification of the minima and saddle points was incorrect, and mass
distribution comes out elongated East-West instead of North-South.
The mass distribution also appears somewhat jagged and the
saddle-point contours are not as clean as in the previous examples;
these are often indicators of a problem with the model.  The enclosed
mass is, however, none the worse --- the reason is probably that in a
relatively symmetrical image configuration, the Einstein radius is quite
well constrained by the images in a fairly model-independent way.

To conclude this set of examples, Figure \ref{fig:6919} shows another
type of quad.  Actually, in this case the brightest part of the source
is only doubly imaged, but the source extends into a region that
produces four images.  We can also see from the real arrival-time
surface that a point source is a double on the verge of splitting into
a quad.  The modeler interpreted the system as a quad.  The
appearance of the arcs, shown in the bottom panel of Figure
\ref{fig:input-spag}, looks like an arc and counter-image such as
discussed with Figure \ref{fig:6990} above.  But there is an important
difference: the long arc is closer to the galaxy, as if the arc and
counter-image have swapped roles.  This configuration arises if the
source displacement is perpendicular to the long axis of the lensing
mass.

\subsection{Test of image identification} \label{sec:tests.t1}

A first manual evaluation tested the volunteers ability to reconstruct the arrival time surface given a survey image containing a sim.
This task consists of two parts.
First to correctly identify and locate the lensed images.
Second the correct ordering for the identified lensed images in respect of the arrival time.

While we expected the identification of lensed images to be trivial, given the nature of the survey images and the success of \sw, we expect the correct ordering to be more difficult.
This part tests the volunteers understandings of the theory of arrival time surfaces and the odd number theorem.
While we can provide the volunteers with some general rules of thumb, ordering involves imagination and guessing and therefore training could improve results in a later stage.

This first test was designed to give some feedback on the difficulties volunteers encounter, to further improve the tutorial materials.

The evaluation of the volunteers performance was done manually, comparing their input from \spl and the resulting reconstructed arrival time surface contour line plot (arrival plot) to the arrival plot generated using simulation parameters.
% \Figref{output_compare} shows the setup used to evaluate the models.

The images of the system are considered to be identified correctly, if all the images have been identified and are approximated within $\pm0.05\cdot\text{imgage width}$.
The parity is considered correct, if those identified points have the right ordering with respect to arrival time.

Additionally, ten types of errors (labeled E01 -- E10, listed in \tabref{stats}) that occurred were identified.
Each generated model could contain more than one error.

\begin{table}\centering\begin{tabular}{llcc}\hline
 & & n & p \\
\hline
 N: & Total number of models & 119 & 1.00\\
\hline
 R1: & images approx. on right location & 110 & 0.92\\
 R2: & images with correct parity & 70 & 0.59\\
\hline
 E01: & inaccurate in arc & 21 & 0.18\\
 E02: & wrong parity in 3 lens conf. & 2 & 0.02\\
 E03: & identified 3 of 5 imgs. & 5 & 0.04\\
 E04: & modeled arc with single img. & 4 & 0.03\\
 E05: & $\pi$ rotated parity & 7 & 0.06\\
 E06: & $\pi$/2 rotated parity & 38 & 0.32\\
 E07: & missed faint img. & 1 & 0.01\\
 E08: & too many imgs in arc. & 5 & 0.04\\
 E09: & missed double img & 3 & 0.03\\
 E10: & too many imgs. & 1 & 0.01\\
\end{tabular}

\caption{1. col: id of model; 2.col: places of imgs idendited
  correctly; 3. col: more or less correct identification of extr
  points. 4.col: exact identification of extremal points. 5.col:
  type(s) of errors ocured....  1) inaccurate placement in an extended
  arc; 2) wrongly identified sad and min in 3 image configuration; 3)
  identified only 3 instead of 5 images; 4) tried to model an arc with
  a min instead of min-sad-min; 5) PI-err (rotation by 180 degrees; in
  5 image configuration, exchanged the ordering of the two saddle
  points); 6) PI/2-err (rotation by 90 degree; sad-min-sad-min-sad);
  7) missed faint image(s); 8) tried to model an arc with min-sad-min
  instead of only min; 9) did identify two close by images as one; 10)
  used 7 or more image to model a 5 image system. }

\label{tab:stats}
\end{table}


\tabref{stats} presents a summary of this evaluation.
We conclude that the volunteers are performing very well identifying and positioning images, with a performance of 92\% (R1, p=0.92).
Most of the problems where due to unclear arc-like structures (E01, p=0.18; E04, p=0.03; E08, p=0.04).
Critical errors like the failure to identify all five images in a five images system (E03, p=0.04) or to include too many images (E10, p=0.01) did almost never happen.
From this we conclude that the introduction materials was adequate and the volunteers understand the basics of gravitational lensing.

The assignment of the parity of the images was a more difficult task.
In 59\% (R2, p=0.59, N=70) of the cases the volunteers succeeded to identify the right configuration.
Most of the failures are due to E06 (N=38, p=32\%), followed by E05 (N=7, p=6\%).
E06 describes a situation, where the minima and saddle points of a five image configuration were exchanged (rotated by $\pm90\dgr$), see \figref{7022} for an example.
E05 describes a situation, where the ordering of the saddle points was wrong (rotation by $180\dgr$).
While these errors occurred, we suspect they can be avoided with better training material and some examples for the obvious cases.
For more challenging cases, like very symmetrical distribution of the lensed images (for example model 7022, \figref{7022}), those errors should still produce plausible results, as will be explained in the next section.



\subsection{Test of mass-profile recovery} \label{sec:tests.t2}

The second test was to compare the mass distributions of the lens $\kappa(x, y)$ given by the sims and generated by the volunteers.
To get a means of comparing the sims to the models, the total convergence\footnote{often called enclosed mass} $\kappa_{\text{encl}}(r)$ was calculated for both.
The Einstein radius $\Theta_\text{E}$ is defined by $\kappa_{\text{encl}}(\Theta_\text{E})=1$ and gives a number that allows a rough comparison between a sim and a model.
We also let an expert (PS) model three selected systems to compare the results from volunteers to those of a professional.


To compare the enclosed mass profile and the Einstein radius of the simulation and the models, \kenc was calculated using the mass map \kap[x,y] generated in the modeling process.
From the ensemble of models generated by one modeling process, the mean is taken as the resulting $\kappa(r)$ to calculate \ERg.
To estimate the errors, the extremal models are used to estimate a lower and upper limit for \ERg.
These results can be seen in \figref{ER_per_sim}.
This figure shows that this technique of estimating the error using the ensemble of all models underestimates the error significantly and should be improved for further analysis.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.80\textwidth]{fig/eR_4}
  \caption{Relative \ERf / \ERg[, sim] for models by volunteers (blue cross), models made by an expert (red cross with offset), including rejected models (green squares); binned per sim.}
  \label{fig:ER_per_sim}
\end{figure}

\begin{figure}
  \centering
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/007020_kappa_encl}}
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/007024_kappa_encl}}
  \subfigure{\includegraphics[width=0.45\textwidth]
             {fig/007021_kappa_encl}} \\
  \caption{Enclosed mass \kenc for models of \asw{0h2m} with incorrect image identifications. \figref{7022} shows a model (by an expert) with the correct identifications, while \figref{7025} shows a model with error E06 (parities rotated by $\pi/2$).  Shown here are the \kenc results for two models with error E06 and one model (bottom) with error E05 (parities rotated by $\pi$).}
\label{fig:kapenc_compare_faulty}
\end{figure}

\Figref{ER_per_sim} shows that the calculated \ERf of the models tend to be too high.
The overshoot varies from around 0.2 to 0.4 for good models.
One of the reasons for this is that it is hard to get the center of the lens on spot.
An offset leads to a flatter mass profile for the model compared to the simulation.

Comparing the models from volunteers and experts can be done in Figures \ref{fig:7022}, \ref{fig:7025} and \ref{fig:kapenc_compare_faulty}, where only the
expert got the right configuration (\figref{7022}) but enclosed masses are all fairly similar.  In cases with nearly symmetric image configurations, like this example, it is more difficult to identify the image parities correctly.  Incorrect image-parity identification changes the orientation of the mass distribution \kap[x,y],
but \kenc and thus the \ERf are not influenced that much.

Two additional sims were modeled by an expert, \asw{1hpf} and \asw{0vqg}.
Looking at the results for \ERg for those models in \figref{ER_per_sim}, we conclude that the performance of volunteers (blue crosses) and experts (red crosses, offset) is comparable.
%Note that the models of \asw{0vqg} with \ERg[, rel] around 0.25 (6935 -- 6937) are failed models that show the attempts of a single user, that came finally up with model 6938 as final result.\todo{remove?}

\clearpage
\section{Outlook} \label{sec:todo}

The lens-modeling challenge indicates that the Spacewarps collective
is good, not only for identifying lens candidates for follow-up, but
modeling candidates as well.

There is, however, plenty of room for improvement.

First, the particular modeling strategy implemented is not the only
one possible.  \spl requires modelers to characterize the overall
image structure in abstract terms based on Fermat's principle, and the
placement of mass distributions is done by the computer.  In other
modeling tools, the user puts down a trial mass distribution and has
the machine refine it.  A few of these modeling programs have also
been designed with citizen science in mind, and would be interesting
in the Spacewarps environment.

Second, \spl needs some enhancements.

\begin{itemize}
\item Currently, \spl does not attempt to model the source shape; the
  user identifies the brightest points on the image, and these are
  taken as images of a point-like source, whose positions must be
  reproduced exactly. For generating a synthetic image, a conical
  source profile is assumed. Fitting for the source profile to
  optimize resemblance to the observed lensed image after the lens
  model has been generated, is algorithmically straightforward and
  planned to be implemented.  This would alleviate another problem
  with \spl, which is that there is no numerical figure of merit, and
  assessment of a model is a judgment call based on the synthetic
  image, and on whether the mass distribution and the arrival-time
  surface show suspect features.
\item \spl has a tendency to somewhat overestimate the Einstein radius
  (evident from Figure \ref{fig:ER_per_sim}), and it is also apparent
  that the models tend to be too shallow.  This possible explanation
  is that, while the sims are steeply peaked at the centre, the
  pixellated mass model fixes a comparatively large area near the
  central at constant density.  One way to solve this problem would be
  to introduce smaller pixels in the central region, thus enabled a
  steeper centre.
\item Another limitation so far in \spl is that the lens is assumed to
  be dominated by one galaxy, which puts most galaxy-group lenses
  beyond the reach of the modeler. Since complicated group lenses are
  some of the most interesting candidates present, removing this
  limitation is most desirable.  From the users' point of view, it
  would mean that spaghetti contours with more than one maximum can be
  allowed.  For examples, see Figure 5c in \citep{2001ApJ...557..594R}
  and Figure 4b in \cite{2003ApJ...590...39K}.
\item At present, a single false-color composite is used as the data.
  An option could be added to use all available filters, individually
  or in combination, at the user wishes.
\end{itemize}

The third desirable avenue of improvement is to facilitate
collaborative work.

\begin{itemize}
\item As mentioned above, the option of revising an already-archived
  model is already available.  Desired now are tools for comparing
  different models of a given system, both visually and through
  different statistical measures.  As evidenced by a current
  collaborative modeling effort, a particularly interesting candidate
  can lead to an extended discussion and dozens of models.
\item Better tutorial materials are also needed, and this would
  address some of the problem areas found in the modeling challenge.
  For example, we saw in \secref{tests.t1} that volunteers are most
  prone to making errors in two situations: when in identifying an arc-
  like structure while placing the points, and in identifying the
  correct ordering of the points in nearly-symmetric configurations.
\end{itemize}

\clearpage

\appendix

\section{More on Lensing Theory} \label{sec:more-theory}

In \secref{Fermat}, for the sake of a more intuitive
explanation, we suppressed some constant factors in
equations \eqref{eq:Ageom}, \eqref{eq:Aarriv} and \eqref{eq:Poisson}.
Here we fill in the details.

First let us recall various distance formulas. Comoving distances
involve integrals of the type
\begin{equation}
\int \frac{dz}{\sqrt{\Omega_m(1+z)^3 + \Omega_\Lambda}}
%\raise.5ex\hbox{.}
\end{equation}
Specifically, the comoving distance $D_S$ from observer to source,
$D_{LS}$ from lens to source, and $D_L$ from observer to lens are
given by the above integral, with limits as follows.
\begin{equation}
\begin{aligned}
&D_S    &                                &\int_0^{z_S} \\
\noalign{\medskip}
&D_{LS} & = \frac c{H_0} \ \times \quad  &\int_{z_L}^{z_S} \\
\noalign{\medskip}
&D_L    &                                &\int_0^{z_L}
\end{aligned}
\end{equation}
Angular-diameter distances $d$ can be related to comoving distances
$D$ by scale factors, as follows.
\begin{equation}
\begin{aligned}
D_S &= (1+z_S) \, d_S \\
D_{LS} &= \frac{1+z_S}{1+z_L} \, d_{LS} \\
D_L &= (1+z_L) \, d_L
\end{aligned}
\end{equation}
Consequently, angular-diameter distances are always smaller than
comoving distances.  Moreover, while comoving distances can be simply
added, angular distances cannot:
\begin{equation}
d_S \neq d_L + d_{LS}
\end{equation}

Locations on the lens plane in angular coordinates on the sky, are
expressed as
\begin{equation}
(x,y) = d_L (\theta_x,\theta_y)
\end{equation}

The $A$ areas (with the implicit
constant factor that makes them time delays) and the $\kappa$ density are related to physical arrival
time $t$ and density $\Sigma$ as
\begin{equation}
\begin{aligned}
A           &= \frac{c}{(1+z_L)^2} \frac{D_L D_{LS}}{D_S} \times t \\
\kappa(x,y) &= \frac{4\pi G}{c^2} \frac{D_L D_{LS}}{D_S}
               \times \Sigma(x,y)
\end{aligned}
\end{equation}
Letting the source be offset at $(s_x,s_y)$ rather than at the
origin, we have
\begin{equation}
\begin{aligned}
t_{\rm geom} &= \frac{(1+z_L)^2}{2c} \frac{D_S}{D_L D_{LS}}
\left( (x-s_x)^2 + (y-s_y)^2 \right) \\
\nabla^2 t_{\rm grav} &= -(1+z_L)\frac{8\pi G}{c^3} \, \Sigma(x,y)
\end{aligned}
\end{equation}
We can now compare with equations (2.1) to (2.6)
from \cite{1986ApJ...310..568B}.
%% comparison to be explicited

\section{Miscellaneous}

Maybe discard \figref{ER_all_models}, since the essential information is there in \figref{ER_per_sim}.

\begin{figure}[htbp]
  \centering
    \includegraphics[width=0.80\textwidth]{fig/eR_1}
  \caption{\ERf for all models with estimated errors in blue squares, \ERg of simulation in red crosses}
  \label{fig:ER_all_models}
\end{figure}


\newpage

\bibliographystyle{apj}
\bibliography{bib/ms}

\end{document}

