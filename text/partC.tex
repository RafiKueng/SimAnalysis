\appendix

\section{Relation to standard lensing formalism}\label{more-theory}

The presentation of the arrival-time surface in \S\secref{Fermat}
and \secref{arriv} omitted some details for the sake of a more
intuitive explanation.  Specifically, the geometric time delay $t_{\rm
geom}$ and the convergence $\kappa$ were left as proportionalities
(equations
\ref{eq:tgeom} and \ref{eq:kappa}), and the gravitational time delay
$t_{\rm grav}$ was given in an implicit form (equation
\ref{eq:tgrav}).  We now fill in the details.

The original formulation of the arrival-time surface appears in
equations (2.1) to (2.6) of \cite{1986ApJ...310..568B}.  Their
equations can be rearranged as follows.
\begin{equation} \label{cfBN86}
\begin{aligned}
t_{\rm geom} &= \frac{(1+z_L)}{2c} \frac{d_S}{d_L d_{LS}}
\left[ (x-s_x)^2 + (y-s_y)^2 \right] \\
\nabla^2 t_{\rm grav} &= -(1+z_L)\frac{8\pi G}{c^3} \, \Sigma(x,y) \\
\kappa(x,y) &= \frac{4\pi G}{c^2} \frac{d_L d_{LS}}{d_S}
               \times \Sigma(x,y)
\end{aligned}
\end{equation}
We symbols $d_L,d_S$ and $d_{LS}$ are angular-diameter distances,
respectively from observer to lens, observer to source, and lens to
source.  In the concordance cosmology, we have
\begin{equation}
d_{LS} = \frac{c}{H_0}\,\frac1{1+z_S} \,
\int_{z_L}^{z_S} \!\! \frac{dz}{\sqrt{\Omega_m(1+z)^3 + \Omega_\Lambda}}
%\raise.5ex\hbox{.}
\end{equation}
and similarly $d_S$ and $d_{LS}$.  We have replaced angular positions
on the sky with positions on the lens plane as
\begin{equation}
(x,y) = d_L (\theta_x,\theta_y) \,.
\end{equation}

The first line of equation \eqref{cfBN86} is $t_{\rm geom}$ from
equation \eqref{eq:tgeom} with the proportionality filled in, and with
the source offset at $(s_x,s_y)$ rather than at the origin.

The last line of equation \eqref{cfBN86} fills in the proportionality
factor in equation \eqref{eq:kappa} for the convergence (or
dimensionless surface density) $\kappa$.

The middle line of equation \eqref{cfBN86} is a Poisson equation for
the gravitational time delay, and is equivalent to the implicit
expression \eqref{eq:tgrav}.  One way to verify the equivalence is to
consider the small circle in equation \eqref{eq:tgrav} as a region
where $\Sigma$ is constant, and approximate $\tgrav$ by its Taylor
expansion to $O(x^2,y^2)$.  Substituting in equations \eqref{cfBN86}
gives the Taylor coefficients in terms of $\Sigma$, and result
satisfies the expression \eqref{eq:tgrav}.  Alternatively, we can
proceed with a discrete form of the Poission equation \eqref{cfBN86}.
Discretising on a grid with spacing $\Delta$, we have
\eqref{eq:tgrav}.  Introducing a small distance $\Delta$, we write
\begin{equation} \label{eq:relax}
\begin{aligned}
\tgrav(x,y) &=
\frac14 \Big[ \tgrav(x+\Delta,y) + \tgrav(x-\Delta,y) + {}\\
&\kern24pt    \tgrav(x,y+\Delta) + \tgrav(x,y-\Delta) \Big] \\
&+ (1+z_L)\frac{2G}{c^3} \, \pi\Delta^2 \, \Sigma(x,y) \,.
\end{aligned}
\end{equation}
This is recognisable as a formula for solving the two-dimensional
Poisson equation from \eqref{cfBN86} by relaxation.  Let us now
replace the average over four neighbouring points by the circular
average $\left\langle \tgrav(x_\subcirc,y_\subcirc) \right\rangle$ and
replace $\pi\Delta^2\,\Sigma(x,y)$ by the enclosed mass
$M(x_\subbullet,y_\subbullet)$.  These replacements are valid in the
limit of a small grid.  The result is the implicit
equation \eqref{eq:tgrav}.

\newpage

